module tb_multiplexer;

  // Parameters
  localparam N = 5;
  localparam M = 4;

  // Inputs
  logic [bit_lenght()-1:0] select;
  logic [N-1:0][M-1:0] channels;

  // Outputs
  logic [M-1:0] out;

  // Instantiate the multiplexer module
  multiplexer #(.N(N), .M(M)) dut (
    .select(select),
    .channels(channels),
    .out(out)
  );

  // Generate clock signal
  always #5 clk = ~clk;

  // Initialize inputs
  initial begin
    select = 0;
    channels = '{
      {4'b0000, 4'b0001, 4'b0010, 4'b0011},
      {4'b0100, 4'b0101, 4'b0110, 4'b0111},
      {4'b1000, 4'b1001, 4'b1010, 4'b1011},
      {4'b1100, 4'b1101, 4'b1110, 4'b1111},
      {4'b1111, 4'b1110, 4'b1101, 4'b1100}
    };
  end

  // Test the multiplexer
  always @(posedge clk) begin
    // Select channel 0
    select <= 0;
    #5;
    assert(out === channels[0]);

    // Select channel 3
    select <= 3;
    #5;
    assert(out === channels[3]);

    // Select channel 4
    select <= 4;
    #5;
    assert(out === channels[4]);
  end

endmodule